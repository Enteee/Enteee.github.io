---
layout: post
categories: []
keywords: []
---

I recently installed nixos


## Lessons Learned

SSH identity files can not be stored in the nix store, because they are world readable ([Pull Request](https://github.com/NixOS/nix/issues/8)).
Convert those file paths to strings instead: `let IdentityFile= toString ../keys/private/ente-duckpond.ch;`

## System Setup

### HIDPI

* Xorg DPI calculations
* Xresources
* URXVT-Scale font

### Clipboard Synchronization

Every linux system has multiple clipboards. I keep them in sync using [autocutsel], which is started as part of the i3 session.

```
services.xserver.windowManager.i3 = {
  enable = true;
  extraSessionCommands = ''
    autocutsel -fork
    autocutsel -selection PRIMARY -fork
  '';
};
```

### Keepass & Otp

For accessing my password store I am using HMAC-based One-time Passwords (HOTP) generated by a YubiKey.
HOTP requires that the password store tracks a counter state of the token.
This means I have to make sure that all systems using that store have to use the very same instance (no copying possible).
Therefore I did put that store on duckpond.ch and mount it using sshfs. This is simple, secure and reliable.

In nix I configured the sshfs mount like this:

```

```

As a password store I am using [KeePass] and the HOTP functionality provided by [OtpKeeProv]. Sadly, [OtpKeeProv] is not packaged in nix, yet.
Pull request [#57786](https://github.com/NixOS/nixpkgs/pull/57786) should fix this. 


```
# ~/.nixpkgs/config.nix

{
  packageOverrides = pkgs: {
    keepass = pkgs.keepass.override {
      plugins = [ pkgs.keepass-keepassotpkeyprov ];
    };
  };
}
```

## Ressources

Configurations I really liked:
* https://gitlab.com/samueldr/nixos-configuration/tree/master
* https://github.com/nocoolnametom/nix-configs

[keepass-keepassotpkeyprov](https://github.com/NixOS/nixpkgs/pull/57786)

[KeePass](https://keepass.info/)
[OtpKeeProv](https://keepass.info/plugins.html#otpkeyprov)
